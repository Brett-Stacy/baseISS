---
title: "Paper Plots V2"
author: "Brett Stacy"
date: "2024-11-25"
output: pdf_document
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, warning = F, message = F, results = "hide", fig.width = 8.5, fig.height = 5, dpi = 600)
library(tidytable)
library(data.table)
library(reshape2)
library(ggplot2)
library(knitr)
library(stringr)
library(patchwork)
opts_knit$set(eval.after = "fig.cap")
options(scipen = 5)
```


# Introduction
Plots for paper:



## Data
```{r}


out_1.4 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_1.4_ISS_1000iters_output_2025-01-23.RDS")

out_3.2 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_3.2_ISS_500iters_output_2025-03-07.RDS") ### mislabeled

out_5.2 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_5.2_ISS_500iters_output_2025-01-27.RDS")

out_9.2 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_9.2_ISS_500iters_output_2025-01-27.RDS")

out_4.2 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_4.2_ISS_500iters_output_2025-01-28.RDS")

out_2.2 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_2.2_ISS_500iters_output_2025-01-28.RDS")

out_31.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_31.1.TAS_ISS_500_iters_2025-03-02.RDS")

out_39.5 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_39.5_ISS_500_iters_2025-03-21.RDS")


# save out_1.4 for Steve to plug into the assessment
out_1.4$length$iss %>% 
  select(YEAR, iss) %>% 
  write.csv(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/Fishery ISS Paper/issb_v1_from_Brett_Stacy.csv", row.names = F)


assessment_2023_iss = tidytable(year = 1977:2023,
                                iss = c(27,
                                45,
                                54,
                                54,
                                63,
                                31,
                                117,
                                140,
                                211,
                                216,
                                396,
                                401,
                                185,
                                189,
                                1565,
                                1543,
                                913,
                                1435,
                                1561,
                                2020,
                                2142,
                                2046,
                                2722,
                                2960,
                                3140,
                                3446,
                                4301,
                                3608,
                                3455,
                                2694,
                                2115,
                                2502,
                                2218,
                                1975,
                                2596,
                                2776,
                                3293,
                                3604,
                                3324,
                                2821,
                                2469,
                                1899,
                                1367,
                                1048,
                                859,
                                1160,
                                706))




# survey vs observer length measurements
obs_numbers = tidytable(year = 1982:2023,
                        survey = c(10863,
                        13143,
                        12133,
                        17150,
                        15872,
                        9483,
                        6950,
                        4246,
                        5428,
                        7069,
                        10129,
                        10500,
                        12931,
                        9820,
                        9348,
                        9591,
                        9574,
                        11183,
                        12170,
                        19078,
                        12365,
                        11835,
                        10986,
                        11753,
                        12530,
                        13441,
                        15328,
                        23737,
                        21223,
                        25150,
                        30177,
                        19902,
                        29204,
                        19880,
                        19507,
                        15020,
                        8806,
                        23408,
                        0,
                        17397,
                        16677,
                        19943),
                        fishery = c(9658,
                                    33200,
                                    45635,
                                    66940,
                                    58257,
                                    129226,
                                    111065,
                                    58625,
                                    39698,
                                    347227,
                                    344923,
                                    248967,
                                    359147,
                                    344794,
                                    445217,
                                    474908,
                                    438746,
                                    186233,
                                    199708,
                                    210419,
                                    230802,
                                    288854,
                                    237487,
                                    228664,
                                    179782,
                                    140663,
                                    164860,
                                    147875,
                                    131514,
                                    172269,
                                    192273,
                                    211962,
                                    234476,
                                    213888,
                                    182980,
                                    157482,
                                    124004,
                                    86800,
                                    65301,
                                    55858,
                                    73025,
                                    42942))


obs_numbers %>% 
  tidytable::summarise(sum(survey), sum(fishery))

obs_numbers %>% 
  tidytable::summarise(mean(survey), mean(fishery))




```


## ISSB Results 
### * Time series 2 panel 

```{r, fig.height=6}
df = data.frame(rss = out_1.4$length$rss$rss, year = as.factor(out_1.4$length$rss$YEAR))



# par(mfrow = c(4,1), mar = c(0,0,0,0), oma = c(2, 4, 2, .5), mgp = c(2, .6, 0))
# par(mfrow = c(3,1), mar = c(1.5, 3.1, 0, .5), mgp = c(2, .6, 0))
par(mfrow = c(2,1), mar = c(0,3.1,0,0), oma = c(3, 0, 2, .5), mgp = c(2, .6, 0))
plot(out_1.4$length$iss$YEAR, out_1.4$length$iss$iss, type = "o", pch = 19, ylab = "ISS", xaxt = "n", ylim = c(0, 15000), cex.lab = 1.3) 
lines(assessment_2023_iss$year, assessment_2023_iss$iss, col = "blue", type = "o", pch = 3)
lines(out_1.4$length$iss$YEAR, out_1.4$length$iss$nhls, col = "orange", type = "o", 5)
legend(1977, 11000, lty = c(1,1,1), col = c("black", "blue", "orange"), pch = c(19, 3, 5), legend = c("ISSB", "ISSA", "number of hauls"), bty = "n")
text(1977, 14000, "A")



plot(out_1.4$length$iss$YEAR, out_1.4$length$iss$nss, type = "l", ylab = "Nominal Sample Size", xlab = "Year", cex.lab = 1.3) 
text(1977, 420000, "B")
mtext("Year", side = 1, line = 2, cex = 1.5)


# averages
out_1.4$length$iss$iss %>% mean()
assessment_2023_iss$iss %>% mean()


```






### * Time seris components

\newpage

```{r, fig.height=5.5}
sub_range = out_5.2$length$iss$YEAR %in% 1977:2023

par(mfrow = c(1,1))
plot(out_5.2$length$iss$YEAR[sub_range], out_5.2$length$iss$iss[sub_range], ylab = "ISSB", cex.lab = 1.3, col = "cyan", ylim = c(0, 25000), xlab = "Year", lwd = 2, type = "o", pch= 18)
lines(out_9.2$length$iss$YEAR[sub_range], out_9.2$length$iss$iss[sub_range], type = "o", pch = 15, col = "orange3", lwd = 2)
lines(out_4.2$length$iss$YEAR[sub_range], out_4.2$length$iss$iss[sub_range], type = "o", pch = 17, col = "magenta", lwd = 2)
lines(out_2.2$length$iss$YEAR[sub_range], out_2.2$length$iss$iss[sub_range], type = "o", pch = 23, col = "green", lwd = 2)
lines(out_1.4$length$iss$YEAR[sub_range], out_1.4$length$iss$iss[sub_range], type = "o", pch = 19, col = "black", lwd = 2, lty = 1)



# legend("topleft", title = "Component Case", legend = c("1", "2", "3", "4", "full"), lty = c(1,1,1,1,1), col = c("black", "blue", "orange", "green", "red"), bty = "n")
legend("topleft", title = "Component Case", legend = c("1", "2", "3", "4", "full"), lty = c(1,1,1,1,1), pch = c(18, 15, 17, 23, 19), col = c("cyan", "orange3", "magenta", "green", "black"), bty = "n", lwd = rep(2, 5))




# not accounting for correlations exceed hauls?
sum((out_5.2$length$iss$iss[sub_range]-out_1.4$length$iss$nhls) < 0)


```

\newpage


#### * TOGETHER

\newpage

```{r, fig.height=8}
df = data.frame(rss = out_1.4$length$rss$rss, year = as.factor(out_1.4$length$rss$YEAR))



# par(mfrow = c(4,1), mar = c(0,0,0,0), oma = c(2, 4, 2, .5), mgp = c(2, .6, 0))
# par(mfrow = c(3,1), mar = c(1.5, 3.1, 0, .5), mgp = c(2, .6, 0))
par(mfrow = c(3,1), mar = c(0,3.1,0,0), oma = c(3, 0, 2, .5), mgp = c(2, .6, 0))
plot(out_1.4$length$iss$YEAR, out_1.4$length$iss$iss, type = "o", pch = 19, ylab = "ISS", xaxt = "n", ylim = c(0, 15000), cex.lab = 1.3) 
lines(assessment_2023_iss$year, assessment_2023_iss$iss, col = "blue", type = "o", pch = 3)
lines(out_1.4$length$iss$YEAR, out_1.4$length$iss$nhls, col = "orange", type = "o", 5)
legend(1977, 11000, lty = c(1,1,1), col = c("black", "blue", "orange"), pch = c(19, 3, 5), legend = c("ISSB", "ISSA", "number of hauls"), bty = "n")
text(1977, 14000, "A")



plot(out_1.4$length$iss$YEAR, out_1.4$length$iss$nss, type = "l", ylab = "Nominal Sample Size", xaxt = "n", cex.lab = 1.3) 
text(1977, 420000, "B")


plot(out_5.2$length$iss$YEAR[sub_range], out_5.2$length$iss$iss[sub_range], ylab = "ISSB", cex.lab = 1.3, col = "cyan", ylim = c(0, 25000), xlab = "Year", lwd = 1.5, type = "o", pch= 18)
lines(out_9.2$length$iss$YEAR[sub_range], out_9.2$length$iss$iss[sub_range], type = "o", pch = 15, col = "orange3", lwd = 1.5)
lines(out_4.2$length$iss$YEAR[sub_range], out_4.2$length$iss$iss[sub_range], type = "o", pch = 17, col = "magenta", lwd = 1.5)
lines(out_2.2$length$iss$YEAR[sub_range], out_2.2$length$iss$iss[sub_range], type = "o", pch = 23, col = "green", lwd = 1.5)
lines(out_1.4$length$iss$YEAR[sub_range], out_1.4$length$iss$iss[sub_range], type = "o", pch = 19, col = "black", lwd = 1.5, lty = 1)
legend(1977, 20000, title = "Component Case", legend = c("1", "2", "3", "4", "full"), lty = c(1,1,1,1,1), pch = c(18, 15, 17, 23, 19), col = c("cyan", "orange3", "magenta", "green", "black"), bty = "n", lwd = rep(1.5, 5))
text(1977, 23000, "C")


mtext("Year", side = 1, line = 2, cex = 1.3)




```




\newpage




* Samples VS Expantion. intra-relative

Make sure to say in the paper: Methods: Unlike changing the number of hauls or trips (static quality of the data), the stock assessor has discression over changing the expansion method. IF they change it, they will change it for past and present data, not change it based on blocks of time or something like that. SO, these scenarios demonstrate what we can expect to see in near future years IF we decrease the sample size, ASSUMING the expansion complexity will change. For example, IF the expansion complexity will change, what will be the expected loss of precision if we reduce the sample size from 20 to 10. REMEMBER, these scenarios are relative to the N=20 case for each expansion complexity case. 


```{r, fig.width=8}

out_22.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_38.2_ISS_500_iters_2025-03-20.RDS")

year = out_22.1$samples_1$expansion_NULL$length$iss$YEAR


df = tidytable(year = year,
               N1_Enone = out_22.1$samples_1$expansion_NULL$length$iss$iss,
               N5_Enone = out_22.1$samples_5$expansion_NULL$length$iss$iss,
               N10_Enone = out_22.1$samples_10$expansion_NULL$length$iss$iss,
               N15_Enone = out_22.1$samples_15$expansion_NULL$length$iss$iss,
               N20_Enone = out_22.1$samples_20$expansion_NULL$length$iss$iss,
               N1_Emedium = out_22.1$samples_1$expansion_haul_numbers$length$iss$iss,
               N5_Emedium = out_22.1$samples_5$expansion_haul_numbers$length$iss$iss,
               N10_Emedium = out_22.1$samples_10$expansion_haul_numbers$length$iss$iss,
               N15_Emedium = out_22.1$samples_15$expansion_haul_numbers$length$iss$iss,
               N20_Emedium = out_22.1$samples_20$expansion_haul_numbers$length$iss$iss,
               N1_Efull = out_22.1$samples_1$expansion_haul_month_numbers$length$iss$iss,
               N5_Efull = out_22.1$samples_5$expansion_haul_month_numbers$length$iss$iss,
               N10_Efull = out_22.1$samples_10$expansion_haul_month_numbers$length$iss$iss,
               N15_Efull = out_22.1$samples_15$expansion_haul_month_numbers$length$iss$iss,
               N20_Efull = out_22.1$samples_20$expansion_haul_month_numbers$length$iss$iss) 

df2 = melt.data.table(df, id.vars = "year", variable.name = "scenario", value.name = "ISS")

df2[grep("Enone", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_Enone"])/df2$ISS[df2$scenario=="N20_Enone"],
                    type = "Enone",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.1

df2[grep("Emedium", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_Emedium"])/df2$ISS[df2$scenario=="N20_Emedium"],
                    type = "Emedium",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -9)) -> df3.2

df2[grep("Efull", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_Efull"])/df2$ISS[df2$scenario=="N20_Efull"],
                    type = "Efull",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.3

df3.1 %>% 
  tidytable::bind_rows(df3.2) %>% 
  tidytable::bind_rows(df3.3) %>% 
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) -> df4
df4 -> df4.0


df4 %>% 
  ggplot(aes(x = scenario, y = ISS.error*100)) +
  geom_boxplot(aes(fill = type)) +
  labs(x = "Samples per Haul", y = "ISSB % Difference") +
  theme_classic() +
  theme(legend.position = c(0.5, 0.2)) +
  geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
  scale_y_continuous(breaks = seq(-100, 120, by = 10)) +
  scale_x_discrete(labels = c("1", "5", "10", "15", "20"))


# Stats
df4 %>% filter(type=="trip", scenario=="N_0.25") %>% pull(ISS.error) %>% median
df4 %>% filter(type=="trip", scenario=="N_2.00") %>% pull(ISS.error) %>% median
df4 %>% filter(type=="haul", scenario=="N_0.25") %>% pull(ISS.error) %>% median
df4 %>% filter(type=="haul", scenario=="N_2.00") %>% pull(ISS.error) %>% median


```






### * Samples VS Expantion. inter-relative
DON'T SHOW THIS ONE BECAUSE IT IS LESS RELEVANT THAN THE ABOVE
```{r, fig.width=8, eval=F}

out_22.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_38.2_ISS_500_iters_2025-03-20.RDS")

year = out_22.1$samples_1$expansion_NULL$length$iss$YEAR


df = tidytable(year = year,
               N1_Enone = out_22.1$samples_1$expansion_NULL$length$iss$iss,
               N5_Enone = out_22.1$samples_5$expansion_NULL$length$iss$iss,
               N10_Enone = out_22.1$samples_10$expansion_NULL$length$iss$iss,
               N15_Enone = out_22.1$samples_15$expansion_NULL$length$iss$iss,
               N20_Enone = out_22.1$samples_20$expansion_NULL$length$iss$iss,
               N1_Emedium = out_22.1$samples_1$expansion_haul_numbers$length$iss$iss,
               N5_Emedium = out_22.1$samples_5$expansion_haul_numbers$length$iss$iss,
               N10_Emedium = out_22.1$samples_10$expansion_haul_numbers$length$iss$iss,
               N15_Emedium = out_22.1$samples_15$expansion_haul_numbers$length$iss$iss,
               N20_Emedium = out_22.1$samples_20$expansion_haul_numbers$length$iss$iss,
               N1_Efull = out_22.1$samples_1$expansion_haul_month_numbers$length$iss$iss,
               N5_Efull = out_22.1$samples_5$expansion_haul_month_numbers$length$iss$iss,
               N10_Efull = out_22.1$samples_10$expansion_haul_month_numbers$length$iss$iss,
               N15_Efull = out_22.1$samples_15$expansion_haul_month_numbers$length$iss$iss,
               N20_Efull = out_22.1$samples_20$expansion_haul_month_numbers$length$iss$iss,
               
               NN = out_1.4$length$iss$iss[out_1.4$length$iss$YEAR%in%1999:2023]) 

df2 = melt.data.table(df, id.vars = "year", variable.name = "scenario", value.name = "ISS")

df2[grep("Enone", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "Enone",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.1

df2[grep("Emedium", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "Emedium",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -9)) -> df3.2

df2[grep("Efull", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "Efull",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.3

df3.1 %>% 
  tidytable::bind_rows(df3.2) %>% 
  tidytable::bind_rows(df3.3) %>% 
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) -> df4
df4 -> df4.0


df4 %>% 
  ggplot(aes(x = scenario, y = ISS.error*100)) +
  geom_boxplot(aes(fill = type)) +
  labs(x = "Samples per Haul", y = "ISSB % Difference") +
  theme_classic() +
  theme(legend.position = c(0.5, 0.2)) +
  geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
  scale_y_continuous(breaks = seq(-100, 120, by = 10)) +
  scale_x_discrete(labels = c("1", "5", "10", "15", "20"))


# Stats
df4 %>% filter(type=="trip", scenario=="N_0.25") %>% pull(ISS.error) %>% median
df4 %>% filter(type=="trip", scenario=="N_2.00") %>% pull(ISS.error) %>% median
df4 %>% filter(type=="haul", scenario=="N_0.25") %>% pull(ISS.error) %>% median
df4 %>% filter(type=="haul", scenario=="N_2.00") %>% pull(ISS.error) %>% median


```








### DATA: Samples VS Haul 
```{r, fig.width=8}

out_24.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_40.1_ISS_500_iters_2025-03-19.RDS")

year = out_24.1$samples_1$haul_0.25$length$iss$YEAR


df = tidytable(year = year,
               N1_H0.25 = out_24.1$samples_1$haul_0.25$length$iss$iss,
               N5_H0.25 = out_24.1$samples_5$haul_0.25$length$iss$iss,
               N10_H0.25 = out_24.1$samples_10$haul_0.25$length$iss$iss,
               N15_H0.25 = out_24.1$samples_15$haul_0.25$length$iss$iss,
               N20_H0.25 = out_24.1$samples_20$haul_0.25$length$iss$iss,
               N1_H0.5 = out_24.1$samples_1$haul_0.5$length$iss$iss,
               N5_H0.5 = out_24.1$samples_5$haul_0.5$length$iss$iss,
               N10_H0.5 = out_24.1$samples_10$haul_0.5$length$iss$iss,
               N15_H0.5 = out_24.1$samples_15$haul_0.5$length$iss$iss,
               N20_H0.5 = out_24.1$samples_20$haul_0.5$length$iss$iss,
               N1_H0.75 = out_24.1$samples_1$haul_0.75$length$iss$iss,
               N5_H0.75 = out_24.1$samples_5$haul_0.75$length$iss$iss,
               N10_H0.75 = out_24.1$samples_10$haul_0.75$length$iss$iss,
               N15_H0.75 = out_24.1$samples_15$haul_0.75$length$iss$iss,
               N20_H0.75 = out_24.1$samples_20$haul_0.75$length$iss$iss,
               N1_H1.0 = out_31.1$samples_1$data_H_P$length$iss$iss,
               N5_H1.0 = out_31.1$samples_5$data_H_P$length$iss$iss,
               N10_H1.0 = out_31.1$samples_10$data_H_P$length$iss$iss,
               N15_H1.0 = out_31.1$samples_15$data_H_P$length$iss$iss,
               N20_H1.0 = out_31.1$samples_20$data_H_P$length$iss$iss,
               
               NN = out_1.4$length$iss$iss[out_1.4$length$iss$YEAR%in%1999:2023]) 

df2 = melt.data.table(df, id.vars = "year", variable.name = "scenario", value.name = "ISS")

df2[grep("H0.25", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.25",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.1

df2[grep("H0.5", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.5",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.2

df2[grep("H0.75", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.75",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.3

df2[grep("H1.0", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "1.0",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.4





df3.1 %>% 
  tidytable::bind_rows(df3.2) %>% 
  tidytable::bind_rows(df3.3) %>% 
  tidytable::bind_rows(df3.4) %>% 
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) -> df4
df4 -> df4.1.b



```






### DATA: Samples VS Haul. Replace=TRUE, including 1.0
```{r, fig.width=8}

out_24.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_40.2_ISS_500_iters_2025-03-23.RDS")

year = out_24.1$samples_1$haul_0.25$length$iss$YEAR


df = tidytable(year = year,
               N1_H0.25 = out_24.1$samples_1$haul_0.25$length$iss$iss,
               N5_H0.25 = out_24.1$samples_5$haul_0.25$length$iss$iss,
               N10_H0.25 = out_24.1$samples_10$haul_0.25$length$iss$iss,
               N15_H0.25 = out_24.1$samples_15$haul_0.25$length$iss$iss,
               N20_H0.25 = out_24.1$samples_20$haul_0.25$length$iss$iss,
               N1_H0.5 = out_24.1$samples_1$haul_0.5$length$iss$iss,
               N5_H0.5 = out_24.1$samples_5$haul_0.5$length$iss$iss,
               N10_H0.5 = out_24.1$samples_10$haul_0.5$length$iss$iss,
               N15_H0.5 = out_24.1$samples_15$haul_0.5$length$iss$iss,
               N20_H0.5 = out_24.1$samples_20$haul_0.5$length$iss$iss,
               N1_H0.75 = out_24.1$samples_1$haul_0.75$length$iss$iss,
               N5_H0.75 = out_24.1$samples_5$haul_0.75$length$iss$iss,
               N10_H0.75 = out_24.1$samples_10$haul_0.75$length$iss$iss,
               N15_H0.75 = out_24.1$samples_15$haul_0.75$length$iss$iss,
               N20_H0.75 = out_24.1$samples_20$haul_0.75$length$iss$iss,
               N1_H1.0 = out_24.1$samples_1$haul_1$length$iss$iss,
               N5_H1.0 = out_24.1$samples_5$haul_1$length$iss$iss,
               N10_H1.0 = out_24.1$samples_10$haul_1$length$iss$iss,
               N15_H1.0 = out_24.1$samples_15$haul_1$length$iss$iss,
               N20_H1.0 = out_24.1$samples_20$haul_1$length$iss$iss,
               
               NN = out_1.4$length$iss$iss[out_1.4$length$iss$YEAR%in%1999:2023]) 

df2 = melt.data.table(df, id.vars = "year", variable.name = "scenario", value.name = "ISS")

df2[grep("H0.25", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_H1.0"])/df2$ISS[df2$scenario=="N20_H1.0"],
                    type = "0.25",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.1

df2[grep("H0.5", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_H1.0"])/df2$ISS[df2$scenario=="N20_H1.0"],
                    type = "0.5",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.2

df2[grep("H0.75", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_H1.0"])/df2$ISS[df2$scenario=="N20_H1.0"],
                    type = "0.75",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.3

df2[grep("H1.0", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_H1.0"])/df2$ISS[df2$scenario=="N20_H1.0"],
                    type = "1.0",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.4





df3.1 %>% 
  tidytable::bind_rows(df3.2) %>% 
  tidytable::bind_rows(df3.3) %>% 
  tidytable::bind_rows(df3.4) %>% 
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) -> df4
df4 -> df4.1.b



```





### DATA: Samples VS Trip
```{r, fig.width=8}

out_23.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_39.2_ISS_500_iters_2025-03-21.RDS")

year = out_23.1$samples_1$trip_0.25$length$iss$YEAR


df = tidytable(year = year,
               N1_T0.25 = out_23.1$samples_1$trip_0.25$length$iss$iss,
               N5_T0.25 = out_23.1$samples_5$trip_0.25$length$iss$iss,
               N10_T0.25 = out_23.1$samples_10$trip_0.25$length$iss$iss,
               N15_T0.25 = out_23.1$samples_15$trip_0.25$length$iss$iss,
               N20_T0.25 = out_23.1$samples_20$trip_0.25$length$iss$iss,
               N1_T0.5 = out_23.1$samples_1$trip_0.5$length$iss$iss,
               N5_T0.5 = out_23.1$samples_5$trip_0.5$length$iss$iss,
               N10_T0.5 = out_23.1$samples_10$trip_0.5$length$iss$iss,
               N15_T0.5 = out_23.1$samples_15$trip_0.5$length$iss$iss,
               N20_T0.5 = out_23.1$samples_20$trip_0.5$length$iss$iss,
               N1_T0.75 = out_23.1$samples_1$trip_0.75$length$iss$iss,
               N5_T0.75 = out_23.1$samples_5$trip_0.75$length$iss$iss,
               N10_T0.75 = out_23.1$samples_10$trip_0.75$length$iss$iss,
               N15_T0.75 = out_23.1$samples_15$trip_0.75$length$iss$iss,
               N20_T0.75 = out_23.1$samples_20$trip_0.75$length$iss$iss,
               N1_T1.0 = out_31.1$samples_1$data_H_P$length$iss$iss,
               N5_T1.0 = out_31.1$samples_5$data_H_P$length$iss$iss,
               N10_T1.0 = out_31.1$samples_10$data_H_P$length$iss$iss,
               N15_T1.0 = out_31.1$samples_15$data_H_P$length$iss$iss,
               N20_T1.0 = out_31.1$samples_20$data_H_P$length$iss$iss,
               
               NN = out_39.5$samples_20$trip_1$length$iss$iss) 
               # NN = out_1.4$length$iss$iss[out_1.4$length$iss$YEAR%in%1999:2023]) 

df2 = melt.data.table(df, id.vars = "year", variable.name = "scenario", value.name = "ISS")

df2[grep("T0.25", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.25",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.1

df2[grep("T0.5", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.5",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.2

df2[grep("T0.75", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.75",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.3

df2[grep("T1.0", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "1.0",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.4





df3.1 %>% 
  tidytable::bind_rows(df3.2) %>% 
  tidytable::bind_rows(df3.3) %>% 
  tidytable::bind_rows(df3.4) %>%
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) -> df4
df4 -> df4.1.a



```





### DATA: Samples VS Trip. Replace=TRUE, including 1.0
```{r, fig.width=8}

out_23.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_39.6_ISS_500_iters_2025-03-23.RDS")

year = out_23.1$samples_1$trip_0.25$length$iss$YEAR


df = tidytable(year = year,
               N1_T0.25 = out_23.1$samples_1$trip_0.25$length$iss$iss,
               N5_T0.25 = out_23.1$samples_5$trip_0.25$length$iss$iss,
               N10_T0.25 = out_23.1$samples_10$trip_0.25$length$iss$iss,
               N15_T0.25 = out_23.1$samples_15$trip_0.25$length$iss$iss,
               N20_T0.25 = out_23.1$samples_20$trip_0.25$length$iss$iss,
               N1_T0.5 = out_23.1$samples_1$trip_0.5$length$iss$iss,
               N5_T0.5 = out_23.1$samples_5$trip_0.5$length$iss$iss,
               N10_T0.5 = out_23.1$samples_10$trip_0.5$length$iss$iss,
               N15_T0.5 = out_23.1$samples_15$trip_0.5$length$iss$iss,
               N20_T0.5 = out_23.1$samples_20$trip_0.5$length$iss$iss,
               N1_T0.75 = out_23.1$samples_1$trip_0.75$length$iss$iss,
               N5_T0.75 = out_23.1$samples_5$trip_0.75$length$iss$iss,
               N10_T0.75 = out_23.1$samples_10$trip_0.75$length$iss$iss,
               N15_T0.75 = out_23.1$samples_15$trip_0.75$length$iss$iss,
               N20_T0.75 = out_23.1$samples_20$trip_0.75$length$iss$iss,
               N1_T1.0 = out_23.1$samples_1$trip_1$length$iss$iss,
               N5_T1.0 = out_23.1$samples_5$trip_1$length$iss$iss,
               N10_T1.0 = out_23.1$samples_10$trip_1$length$iss$iss,
               N15_T1.0 = out_23.1$samples_15$trip_1$length$iss$iss,
               N20_T1.0 = out_23.1$samples_20$trip_1$length$iss$iss,
               
               NN = out_39.5$samples_20$trip_1$length$iss$iss) 
               # NN = out_1.4$length$iss$iss[out_1.4$length$iss$YEAR%in%1999:2023]) 

df2 = melt.data.table(df, id.vars = "year", variable.name = "scenario", value.name = "ISS")

df2[grep("T0.25", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_T1.0"])/df2$ISS[df2$scenario=="N20_T1.0"],
                    type = "0.25",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.1

df2[grep("T0.5", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_T1.0"])/df2$ISS[df2$scenario=="N20_T1.0"],
                    type = "0.5",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.2

df2[grep("T0.75", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_T1.0"])/df2$ISS[df2$scenario=="N20_T1.0"],
                    type = "0.75",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.3

df2[grep("T1.0", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="N20_T1.0"])/df2$ISS[df2$scenario=="N20_T1.0"],
                    type = "1.0",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.4





df3.1 %>% 
  tidytable::bind_rows(df3.2) %>% 
  tidytable::bind_rows(df3.3) %>% 
  tidytable::bind_rows(df3.4) %>%
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) -> df4
df4 -> df4.1.a



```




### * 2 Panel: Sample Size VS Haul, Trip

```{r, fig.height=12, fig.width=10}
p1 = df4.1.a %>%
  tidytable::mutate(scenario = str_sub(scenario, start = 2, end = -1)) %>%
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) %>%
  ggplot(aes(x = scenario, y = ISS.error*100)) +
  geom_boxplot(aes(fill = type)) +
  labs(x = "", y = "ISSB % Difference", tag = "A") +
  theme_classic() +
  theme(legend.position = c(0.7, 0.15),
        legend.direction = "horizontal",
        legend.box = "horizontal",
        plot.tag.position = c(0.1, 0.95),
        plot.tag = element_text(size = 14, face = "bold")) +
  guides(fill = guide_legend(title = "Trips",
                             title.position = "top",
                             title.hjust = 0.5,
                             label.position = "bottom"))  +
  geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
  scale_y_continuous(breaks = seq(-100, 120, by = 10), limits = c(-90, 30))

p2 = df4.1.b %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 2, end = -1)) %>% 
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) %>% 
  ggplot(aes(x = scenario, y = ISS.error*100)) +
  geom_boxplot(aes(fill = type)) +
  labs(x = "", y = "ISSB % Difference", tag = "B") +
  theme_classic() +
  theme(legend.position = c(0.7, 0.15), 
        legend.direction = "horizontal", 
        legend.box = "horizontal",
        plot.tag.position = c(0.1, 0.95),
        plot.tag = element_text(size = 14, face = "bold")) + 
  guides(fill = guide_legend(title = "Hauls",
                             title.position = "top", 
                             title.hjust = 0.5,
                             label.position = "bottom"))  +
  geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
  scale_y_continuous(breaks = seq(-100, 120, by = 10), limits = c(-90, 30))

# p3 = df4.3.b %>% 
#   tidytable::mutate(scenario = factor(str_sub(scenario, start = 2, end = -1))) %>% 
#   tidytable::filter(type %in% scenario_names.short[c(2,4,5,6,7)]) %>%
#   tidytable::mutate(scenario = forcats::fct_inorder(scenario)) %>% 
#   ggplot(aes(x = scenario, y = ISS.error*100)) +
#   geom_boxplot(aes(fill = type)) +
#   labs(x = "Samples per Haul", y = "ISSB % Difference", tag = "C") +
#   theme_classic() +
#   theme(legend.position = c(0.7, 0.15), 
#         legend.direction = "horizontal", 
#         legend.box = "horizontal",
#         plot.tag.position = c(0.1, 0.95),
#         plot.tag = element_text(size = 14, face = "bold")) + 
#   guides(fill = guide_legend(title = "Hauls/Trips",
#                              title.position = "top", 
#                              title.hjust = 0.5,
#                              label.position = "bottom"))  +
#   geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
#   geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
#   scale_y_continuous(breaks = seq(-100, 120, by = 10), limits = c(-90, 30))



p1 + plot_spacer() + p2 + plot_layout(ncol = 1,
                           heights = c(6, -.5, 6))


```






### PROBLEM DATA: Samples VS Trip

replace=false for trips is problematic.


```{r, fig.width=8}

out_23.1 = readRDS(file = "C:/Users/bstacy2/OneDrive - UW/UW Postdoc/GitHub Repos/baseISS_data/outputs/paper_output/paper_scenario_39.3_ISS_10_iters_2025-03-21.RDS")

year = out_23.1$samples_1$trip_0.25$length$iss$YEAR


df = tidytable(year = year,
               N1_T0.25 = out_23.1$samples_1$trip_0.25$length$iss$iss,
               N5_T0.25 = out_23.1$samples_5$trip_0.25$length$iss$iss,
               N10_T0.25 = out_23.1$samples_10$trip_0.25$length$iss$iss,
               N15_T0.25 = out_23.1$samples_15$trip_0.25$length$iss$iss,
               N20_T0.25 = out_23.1$samples_20$trip_0.25$length$iss$iss,
               N1_T0.5 = out_23.1$samples_1$trip_0.5$length$iss$iss,
               N5_T0.5 = out_23.1$samples_5$trip_0.5$length$iss$iss,
               N10_T0.5 = out_23.1$samples_10$trip_0.5$length$iss$iss,
               N15_T0.5 = out_23.1$samples_15$trip_0.5$length$iss$iss,
               N20_T0.5 = out_23.1$samples_20$trip_0.5$length$iss$iss,
               N1_T0.75 = out_23.1$samples_1$trip_0.75$length$iss$iss,
               N5_T0.75 = out_23.1$samples_5$trip_0.75$length$iss$iss,
               N10_T0.75 = out_23.1$samples_10$trip_0.75$length$iss$iss,
               N15_T0.75 = out_23.1$samples_15$trip_0.75$length$iss$iss,
               N20_T0.75 = out_23.1$samples_20$trip_0.75$length$iss$iss,
               N1_T0.9 = out_23.1$samples_1$trip_0.9$length$iss$iss,
               N5_T0.9 = out_23.1$samples_5$trip_0.9$length$iss$iss,
               N10_T0.9 = out_23.1$samples_10$trip_0.9$length$iss$iss,
               N15_T0.9 = out_23.1$samples_15$trip_0.9$length$iss$iss,
               N20_T0.9 = out_23.1$samples_20$trip_0.9$length$iss$iss,
               N1_T1.0 = out_31.1$samples_1$data_H_P$length$iss$iss,
               N5_T1.0 = out_31.1$samples_5$data_H_P$length$iss$iss,
               N10_T1.0 = out_31.1$samples_10$data_H_P$length$iss$iss,
               N15_T1.0 = out_31.1$samples_15$data_H_P$length$iss$iss,
               N20_T1.0 = out_31.1$samples_20$data_H_P$length$iss$iss,
               
               NN = out_1.4$length$iss$iss[out_1.4$length$iss$YEAR%in%1999:2023]) 

df2 = melt.data.table(df, id.vars = "year", variable.name = "scenario", value.name = "ISS")

df2[grep("T0.25", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.25",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.1

df2[grep("T0.5", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.5",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.2

df2[grep("T0.75", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.75",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -7)) -> df3.3

df2[grep("T1.0", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "1.0",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.4

df2[grep("T0.9", scenario)] %>% 
  tidytable::mutate(ISS.error = (ISS - df2$ISS[df2$scenario=="NN"])/df2$ISS[df2$scenario=="NN"],
                    type = "0.9",
                    .by = scenario) %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 1, end = -6)) -> df3.5





df3.1 %>% 
  tidytable::bind_rows(df3.2) %>% 
  tidytable::bind_rows(df3.3) %>% 
  tidytable::bind_rows(df3.5) %>% 
  tidytable::bind_rows(df3.4) %>% 
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) -> df4
df4 -> df4.1.a



```




### * 2 Panel: Sample Size VS Haul, Trip

```{r, fig.height=12, fig.width=10}
p1 = df4.1.a %>%
  tidytable::mutate(scenario = str_sub(scenario, start = 2, end = -1)) %>%
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) %>%
  ggplot(aes(x = scenario, y = ISS.error*100)) +
  geom_boxplot(aes(fill = type)) +
  labs(x = "", y = "ISSB % Difference", tag = "A") +
  theme_classic() +
  theme(legend.position = c(0.7, 0.15),
        legend.direction = "horizontal",
        legend.box = "horizontal",
        plot.tag.position = c(0.1, 0.95),
        plot.tag = element_text(size = 14, face = "bold")) +
  guides(fill = guide_legend(title = "Trips",
                             title.position = "top",
                             title.hjust = 0.5,
                             label.position = "bottom"))  +
  geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
  scale_y_continuous(breaks = seq(-100, 120, by = 10), limits = c(-90, 30))

p2 = df4.1.b %>% 
  tidytable::mutate(scenario = str_sub(scenario, start = 2, end = -1)) %>% 
  tidytable::mutate(scenario = forcats::fct_inorder(scenario)) %>% 
  ggplot(aes(x = scenario, y = ISS.error*100)) +
  geom_boxplot(aes(fill = type)) +
  labs(x = "", y = "ISSB % Difference", tag = "B") +
  theme_classic() +
  theme(legend.position = c(0.7, 0.15), 
        legend.direction = "horizontal", 
        legend.box = "horizontal",
        plot.tag.position = c(0.1, 0.95),
        plot.tag = element_text(size = 14, face = "bold")) + 
  guides(fill = guide_legend(title = "Hauls",
                             title.position = "top", 
                             title.hjust = 0.5,
                             label.position = "bottom"))  +
  geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
  scale_y_continuous(breaks = seq(-100, 120, by = 10), limits = c(-90, 30))

# p3 = df4.3.b %>% 
#   tidytable::mutate(scenario = factor(str_sub(scenario, start = 2, end = -1))) %>% 
#   tidytable::filter(type %in% scenario_names.short[c(2,4,5,6,7)]) %>%
#   tidytable::mutate(scenario = forcats::fct_inorder(scenario)) %>% 
#   ggplot(aes(x = scenario, y = ISS.error*100)) +
#   geom_boxplot(aes(fill = type)) +
#   labs(x = "Samples per Haul", y = "ISSB % Difference", tag = "C") +
#   theme_classic() +
#   theme(legend.position = c(0.7, 0.15), 
#         legend.direction = "horizontal", 
#         legend.box = "horizontal",
#         plot.tag.position = c(0.1, 0.95),
#         plot.tag = element_text(size = 14, face = "bold")) + 
#   guides(fill = guide_legend(title = "Hauls/Trips",
#                              title.position = "top", 
#                              title.hjust = 0.5,
#                              label.position = "bottom"))  +
#   geom_hline(yintercept = -10, linetype = "dashed", color = "black") +
#   geom_hline(yintercept = 10, linetype = "dashed", color = "black") +
#   scale_y_continuous(breaks = seq(-100, 120, by = 10), limits = c(-90, 30))



p1 + plot_spacer() + p2 + plot_layout(ncol = 1,
                           heights = c(6, -.5, 6))


```




